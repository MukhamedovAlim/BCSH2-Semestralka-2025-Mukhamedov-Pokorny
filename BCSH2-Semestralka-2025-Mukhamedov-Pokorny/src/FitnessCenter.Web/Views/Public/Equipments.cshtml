@model IEnumerable<FitnessCenter.Web.Models.EquipmentViewModel>

@{
    ViewData["Title"] = "Vybavení – veřejný přehled";
    Layout = "_AppLayout";
    ViewBag.Active = "Public";

    var filterTyp = ViewBag.SelectedTyp as string; // můžeš používat stejně jako u interní verze
    var fitka = ViewBag.Fitka as List<Microsoft.AspNetCore.Mvc.Rendering.SelectListItem> ?? new();
    int? fitkoId = ViewBag.FitkoId as int?;

    // helper pro barvičky stavu
    string GetStatusClass(string stav)
    {
        var s = (stav ?? "").Trim().ToUpperInvariant();
        return s switch
        {
            "OK" => "badge bg-success",              // zelená
            "OPRAVA" => "badge bg-warning text-dark",    // žlutá
            "MIMO PROVOZ" => "badge bg-danger",               // červená
            _ => "badge bg-secondary"
        };
    }
}

<div class="d-flex justify-content-between align-items-center mb-3">
    <div>
        <a class="btn btn-outline-light me-2" href="@Url.Action("Index", "Public")">← Zpět</a>
        <span class="h3 text-white mb-0">Vybavení</span>
    </div>
    <div class="text-white-50 small">
        Veřejný přehled vybavení ve Svalovna Gym.
    </div>
</div>

<div class="d-flex justify-content-between align-items-center flex-wrap gap-2 equipment-toolbar mb-2">
    <h5 class="text-white mb-0">Filtrovat vybavení</h5>

    <form method="get"
          action="@Url.Action("Equipments", "Public")"
          class="d-flex gap-2 align-items-center flex-wrap mb-0">

        <div class="btn-group" role="group" aria-label="Typ vybavení">
            <input type="radio" class="btn-check" name="typ" id="typAll" value=""
                   @(string.IsNullOrEmpty(filterTyp) ? "checked" : "") />
            <label class="btn btn-sm btn-outline-light" for="typAll">Vše</label>

            <input type="radio" class="btn-check" name="typ" id="typK" value="K"
                   @(filterTyp == "K" ? "checked" : "") />
            <label class="btn btn-sm btn-outline-light" for="typK">Kardio</label>

            <input type="radio" class="btn-check" name="typ" id="typP" value="P"
                   @(filterTyp == "P" ? "checked" : "") />
            <label class="btn btn-sm btn-outline-light" for="typP">Posilovací</label>

            <input type="radio" class="btn-check" name="typ" id="typV" value="V"
                   @(filterTyp == "V" ? "checked" : "") />
            <label class="btn btn-sm btn-outline-light" for="typV">Volná závaží</label>
        </div>

        <select name="fitko" class="form-select form-select-sm" style="width: 180px;">
            <option value="">Všechna fitka</option>
            @foreach (var f in fitka)
            {
                <option value="@f.Value" @(f.Value == (fitkoId?.ToString() ?? "") ? "selected" : "")>
                    @f.Text
                </option>
            }
        </select>

        <button class="btn btn-sm btn-outline-light" type="submit">Filtrovat</button>
    </form>
</div>

<div class="glass p-3">
    @if (!(Model?.Any() ?? false))
    {
        <div class="text-white-50">Žádné položky odpovídající filtru.</div>
    }
    else
    {
        <div class="row g-3 mt-1">
            @foreach (var it in Model!)
            {
                <div class="col-12 col-md-6 col-xl-4">
                    <div class="tile glass p-3 h-100 equipment-card">
                        <div class="d-flex justify-content-between align-items-start mb-1">
                            <h5 class="text-white mb-0">@it.Nazev</h5>
                            <span class="badge bg-secondary">@it.Typ</span>
                        </div>
                        <div class="text-white-50 small mb-1">
                            Fitko: <strong class="text-white">@it.Fitko</strong>
                        </div>
                        <div class="text-white-50 small mb-1">
                            Stav:
                            <span class="@GetStatusClass(it.Stav) ms-1">@it.Stav</span>
                        </div>

                    </div>
                </div>
            }
        </div>
    }
</div>

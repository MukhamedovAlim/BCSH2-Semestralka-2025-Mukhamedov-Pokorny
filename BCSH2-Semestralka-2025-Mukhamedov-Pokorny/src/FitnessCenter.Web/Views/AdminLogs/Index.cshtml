@model IEnumerable<FitnessCenter.Infrastructure.Repositories.LogRow>
@{
    ViewData["Title"] = "Log operací";
    Layout = "_AppLayout";

    ViewBag.HideMainNav = true;

    string FormatOperace(string op) => op switch
    {
        "INSERT" => "Vytvoření",
        "UPDATE" => "Úprava",
        "DELETE" => "Smazání",
        _ => op
    };

    string OperaceBadgeClass(string op) => op switch
    {
        "INSERT" => "bg-success",
        "UPDATE" => "bg-warning text-dark",
        "DELETE" => "bg-danger",
        _ => "bg-secondary"
    };

    string CleanPopis(string? raw)
    {
        if (string.IsNullOrWhiteSpace(raw))
            return "";

        var idx = raw.IndexOf("ROWID", StringComparison.OrdinalIgnoreCase);
        if (idx > 0)
            return raw[..idx].Trim().TrimEnd('-', ';', ',');

        return raw.Trim();
    }
}
<div class="d-flex justify-content-between align-items-center mb-3">
    <div>
        <a class="btn btn-outline-light me-2" href="@Url.Action("Admin", "Home")">← Zpět</a>
        <span class="h3 text-white mb-0">Log operací</span>
    </div>
</div>

<div class="table-responsive glass p-2">
    <table class="table table-dark table-striped align-middle mb-0">
        <thead>
            <tr>
                <th>Čas</th>
                <th>Tabulka</th>
                <th>Operace</th>
                <th>Kdo</th>
                <th>Popis</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var x in Model)
            {
                <tr>
                    <td>@x.Kdy.ToString("dd.MM.yyyy HH:mm:ss")</td>
                    <td>@x.Tabulka</td>
                    <td>
                        <span class="badge @OperaceBadgeClass(x.Operace)">
                            @FormatOperace(x.Operace)
                        </span>
                    </td>
                    <td>@x.Kdo</td>
                    <td>@CleanPopis(x.Popis)</td>
                </tr>
            }
        </tbody>
    </table>
</div>
